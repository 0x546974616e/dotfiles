# vim: filetype=.gitconfig

[alias]
a = add
aa = add -A

c = commit
cm = commit -m
amend = commit --amend
aacm = !git aa && git cm

b = branch
m = merge
p = push

st = stash
co = checkout

d = diff
ds = diff --stat

dt = difftool
mt = mergetool

lraw = log --decorate --oneline
graw = log --decorate --oneline --graph

# %C(blue)<%an>%C(reset)
# %C(auto)%h (%cs)%d %s
l = lraw --pretty=format:'%C(yellow)%h %C(green)(%cs)%C(reset)%C(auto)%d%C(reset) %s%C(reset)'
g = graw --pretty=format:'%C(yellow)%h %C(green)(%cs)%C(reset)%C(auto)%d%C(reset) %s%C(reset)'

ll = l --name-status
gg = g --all

# Command substitution are executed in subshell.
alias = "!f() { \
  git config --get-regexp '^alias' | grep -Ev \"alias\\.(s|alias\\b)\"; \
  echo alias.s status -s; \
}; f"

ss = status
s = "!f() { \
  if [ -z \"$1\" ]; then \
    test -t 1; \
    local color=$([ $? -eq 0 ] && echo always || echo false); \
    echo \"Changed file\";\
    git -c color.ui=$color status -s | awk '{ print NR, $0 }'; \
    return 1; \
  fi; \
  if [ \"$1\" -eq \"$1\" ] 2>/dev/null; then \
    local path=\"$(git -c color.ui=false status -s | awk \"NR == $1 { print \\$2 }\")\"; \
    if [ -n \"$path\" ]; then \
      echo $1 $path; \
      git diff $path; \
      return 1; \
    fi; \
  fi; \
  echo \"Please provide an existing index.\"; \
}; f"

